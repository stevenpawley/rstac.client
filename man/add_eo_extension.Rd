% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extension-eo.R
\name{add_eo_extension}
\alias{add_eo_extension}
\title{Add EO Extension to a STAC Item}
\usage{
add_eo_extension(
  item,
  bands = NULL,
  cloud_cover = NULL,
  snow_cover = NULL,
  asset_key = NULL
)
}
\arguments{
\item{item}{A STAC Item object created with \code{stac_item()}.}

\item{bands}{(list, optional) A list of band objects created with \code{eo_band()}.
Each band describes the characteristics of a spectral band. If the asset has
multiple bands, provide a list with one entry per band in order.}

\item{cloud_cover}{(numeric, optional) Estimate of cloud cover as a
percentage (0-100). Should only include valid data regions, excluding nodata
areas. If not available or cannot be calculated, should not be provided.}

\item{snow_cover}{(numeric, optional) Estimate of snow/ice cover as a percentage
(0-100) of the entire scene. Should only include valid data regions. If not
available, should not be provided.}

\item{asset_key}{(character, optional) If provided, adds the bands to a specific
asset rather than to the item properties. The cloud_cover and snow_cover
properties will always be added to item properties (not assets) as they
typically apply to the entire scene.}
}
\value{
The modified STAC Item with EO extension fields added.
}
\description{
Adds the Electro-Optical (EO) Extension to a STAC Item. EO data is
considered to be data that represents a snapshot of the Earth for a single date
and time. It could consist of multiple spectral bands in any part of the
electromagnetic spectrum.

\strong{Important Note on STAC 1.1.0 Changes:}
This extension formerly had a field eo:bands, which has been removed in
favor of a general field bands in STAC common metadata. The structure is the
same—it's an array of Band Objects—but fields from the EO extension now have
an \verb{eo:} prefix, while more general fields like \code{description} have been moved
to common metadata and don't need a prefix.
}
\details{
\subsection{Extension Schema URI}{

The EO Extension v1.1.0 schema URI is:
\verb{https://stac-extensions.github.io/eo/v1.1.0/schema.json}
}

\subsection{Band Object Fields}{

Each band can contain the following EO-specific fields (all with \verb{eo:} prefix):
\itemize{
\item \code{eo:common_name}: Common name of the band (e.g., "red", "green", "blue", "nir")
\item \code{eo:center_wavelength}: Center wavelength in micrometers (μm)
\item \code{eo:full_width_half_max}: Full width at half maximum (FWHM) in micrometers
\item \code{eo:solar_illumination}: Solar illumination at the band's wavelength
}

Plus common metadata fields without prefix:
\itemize{
\item \code{name}: Name of the band (e.g., "B01", "B02", "B1", "B5")
\item \code{description}: Description of the band
}
}

\subsection{Common Band Names}{

The EO extension defines standard common names for typical spectral bands:
\itemize{
\item \strong{Visible}: \code{"coastal"}, \code{"blue"}, \code{"green"}, \code{"red"}
\item \strong{Red Edge}: \code{"rededge"}, \code{"rededge071"}, \code{"rededge075"}, \code{"rededge078"}
\item \strong{Near Infrared}: \code{"nir"}, \code{"nir08"}, \code{"nir09"}
\item \strong{Short-wave Infrared}: \code{"cirrus"}, \code{"swir16"}, \code{"swir22"}
\item \strong{Long-wave Infrared}: \code{"lwir"}, \code{"lwir11"}, \code{"lwir12"}
\item \strong{Panchromatic}: \code{"pan"}
}
}

\subsection{Coverage Percentages}{

It is important to consider only the valid data regions, excluding
any "nodata" areas while calculating both the coverages. Usually, cloud_cover
and snow_cover should be used in Item Properties rather than Item Assets, as an
Item from an electro-optical source is a single snapshot of the Earth, so the
coverages usually apply to all assets.
}

\subsection{Wavelength Units}{

For example, if we were given a band described as (0.4um - 0.5um) the
eo:center_wavelength would be 0.45um and the eo:full_width_half_max would be
0.1um.
}

\subsection{Recommended Companion Extensions}{

The EO extension is often used with:
\itemize{
\item \strong{Instrument Fields} (common metadata): platform, instruments, constellation
\item \strong{View Extension}: For view geometry (off-nadir, azimuth, sun angles)
\item \strong{Raster Extension}: For data type, nodata, scale/offset
}
}
}
\examples{
# Create an item
item <- stac_item(
  id = "LC08_L2SP_001002_20230615",
  geometry = my_geometry,
  bbox = my_bbox,
  datetime = "2023-06-15T10:30:00Z",
  properties = list(
    platform = "landsat-8",
    instruments = c("oli", "tirs")
  )
)

# Add EO extension with cloud cover
item <- add_eo_extension(
  item,
  cloud_cover = 12.5
)

# Create multispectral bands
red_band <- eo_band(
  name = "B4",
  common_name = "red",
  center_wavelength = 0.665,
  full_width_half_max = 0.038
)

green_band <- eo_band(
  name = "B3",
  common_name = "green",
  center_wavelength = 0.560,
  full_width_half_max = 0.043
)

blue_band <- eo_band(
  name = "B2",
  common_name = "blue",
  center_wavelength = 0.490,
  full_width_half_max = 0.038
)

nir_band <- eo_band(
  name = "B5",
  common_name = "nir",
  center_wavelength = 0.865,
  full_width_half_max = 0.033
)

# Add bands to the item
item <- item |>
  add_asset(
    "visual",
    href = "https://example.com/LC08_visual.tif",
    type = "image/tiff; application=geotiff",
    roles = c("data")
  ) |>
  add_eo_extension(
    bands = list(red_band, green_band, blue_band, nir_band),
    cloud_cover = 5.2,
    asset_key = "visual"
  )

# Combine EO and Raster extensions
combined_band <- eo_band(
  name = "B4",
  common_name = "red",
  center_wavelength = 0.665,
  full_width_half_max = 0.038,
  description = "Red band (0.64-0.67 μm)"
)

# Add raster properties to the same band
combined_band$nodata <- 0
combined_band$data_type <- "uint16"
combined_band$`raster:spatial_resolution` <- 30
combined_band$`raster:scale` <- 0.0001
combined_band$`raster:offset` <- 0

item <- item |>
  add_eo_extension(bands = list(combined_band)) |>
  add_raster_extension(bands = list(combined_band))

}
\references{
EO Extension Specification:
\url{https://github.com/stac-extensions/eo}
}
\seealso{
\itemize{
\item \code{\link[=eo_band]{eo_band()}} for creating EO band objects
\item \code{\link[=add_raster_extension]{add_raster_extension()}} for adding raster metadata
\item \code{\link[=stac_item]{stac_item()}} for creating STAC Items
}
}
