% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extension-raster.R
\name{add_raster_extension}
\alias{add_raster_extension}
\title{Add Raster Extension to a STAC Item or Asset}
\usage{
add_raster_extension(item, bands, asset_key = NULL)
}
\arguments{
\item{item}{A STAC Item object created with \code{stac_item()}.}

\item{bands}{A list of band objects created with \code{raster_band()}. Each band
describes the characteristics of a single raster band (or layer). If the
asset has multiple bands, provide a list with one entry per band in order.}

\item{asset_key}{(character, optional) If provided, adds the bands to a
specific asset rather than to the item properties. Useful when different
assets have different band structures.}
}
\value{
The modified STAC Item with raster extension fields added.
}
\description{
Adds the Raster Extension to a STAC Item or modifies an asset to include
raster-specific metadata. The Raster Extension describes raster assets at the
band level with information such as data type, nodata values, scale/offset
transforms, and statistics.

\strong{Important Note on STAC 1.1.0 Changes:}
In STAC 1.1.0, the \code{raster:bands} field was deprecated in favor of a common
\code{bands} construct that merges functionality from both \code{eo:bands} and
\code{raster:bands}. Some raster-specific fields (like \code{nodata}, \code{data_type},
\code{statistics}, \code{unit}) are now part of STAC common metadata and should be
included directly in band objects. The remaining raster-specific fields
(\code{raster:sampling}, \code{raster:bits_per_sample}, \code{raster:spatial_resolution},
\code{raster:scale}, \code{raster:offset}, \code{raster:histogram}) retain the \verb{raster:} prefix.
}
\details{
\subsection{Extension Schema URI}{

The Raster Extension v1.1.0 schema URI is:
\verb{https://stac-extensions.github.io/raster/v1.1.0/schema.json}
}

\subsection{Band Object Fields}{

Each band can contain both common metadata fields and raster-specific fields:

\strong{Common Metadata (no prefix):}
\itemize{
\item \code{nodata}: Pixel values to be interpreted as nodata
\item \code{data_type}: Data type of the band (e.g., "uint8", "int16", "float32")
\item \code{unit}: Unit of measurement for pixel values
\item \code{statistics}: Object with min, max, mean, stddev, valid_percent
}

\strong{Raster-Specific (raster: prefix):}
\itemize{
\item \code{raster:sampling}: Pixel sampling method ("area" or "point")
\item \code{raster:bits_per_sample}: Actual number of bits used per sample
\item \code{raster:spatial_resolution}: Average spatial resolution in meters
\item \code{raster:scale}: Multiplicative scaling factor to convert DN to values
\item \code{raster:offset}: Additive offset to convert DN to values
\item \code{raster:histogram}: Histogram distribution of pixel values
}
}

\subsection{Scale and Offset}{

In remote sensing, raster data often stores raw Digital Numbers (DN) that
must be transformed to physical values using:

\strong{value = scale Ã— DN + offset}

For example, storing reflectance (0-1) as integers (0-10000) with scale=0.0001.
}

\subsection{Data Types}{

Supported data type values include:
\itemize{
\item \code{"int8"}, \code{"int16"}, \code{"int32"}, \code{"int64"}
\item \code{"uint8"}, \code{"uint16"}, \code{"uint32"}, \code{"uint64"}
\item \code{"float16"}, \code{"float32"}, \code{"float64"}
\item \code{"cint16"}, \code{"cint32"} (complex integers)
\item \code{"cfloat32"}, \code{"cfloat64"} (complex floats)
\item \code{"other"} (for custom types)
}
}
}
\examples{
# Create an item
item <- stac_item(
  id = "my-raster",
  geometry = list(type = "Point", coordinates = c(-105, 40)),
  bbox = c(-105, 40, -105, 40),
  datetime = "2023-01-01T00:00:00Z"
)

# Add a single-band raster asset
band <- raster_band(
  nodata = 0,
  data_type = "uint16",
  spatial_resolution = 30,
  scale = 0.0001,
  offset = 0
)

item <- add_raster_extension(item, bands = list(band))

# Add multi-band raster with statistics
red_band <- raster_band(
  nodata = 0,
  data_type = "uint16",
  spatial_resolution = 10,
  scale = 0.0001,
  offset = -0.1,
  statistics = raster_statistics(
    minimum = 1,
    maximum = 10000,
    mean = 2500,
    stddev = 1200,
    valid_percent = 99.5
  )
)

green_band <- raster_band(
  nodata = 0,
  data_type = "uint16",
  spatial_resolution = 10,
  scale = 0.0001,
  offset = -0.1
)

item <- item |>
  add_asset(
    key = "visual",
    href = "https://example.com/image.tif",
    type = "image/tiff; application=geotiff",
    roles = c("data")
  ) |>
  add_raster_extension(
    bands = list(red_band, green_band),
    asset_key = "visual"
  )

}
\references{
Raster Extension Specification:
\url{https://github.com/stac-extensions/raster}
}
\seealso{
\itemize{
\item \code{\link[=raster_band]{raster_band()}} for creating band objects
\item \code{\link[=raster_statistics]{raster_statistics()}} for creating statistics objects
\item \code{\link[=raster_histogram]{raster_histogram()}} for creating histogram objects
\item \code{\link[=add_asset]{add_asset()}} for adding assets to items
}
}
